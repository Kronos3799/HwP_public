{% extends 'base.html' %}

{% block content %}
        <!-- main content -->
        <main class="row my-5">
            <!-- article selection -->
            <div class="container mb-5 px-5 py-3 rounded-4 _shadow _bg-whitesmoke">
                <!-- dropdown -->
                <div class="mb-3">
                    <label for="article-selection" class="form-label"><b>Select Article</b></label>
                    <select class="form-select" id="article-selection" name="article-selection">
                        <option value="new" selected>Create New Article</option>
                        {% for article in articles %}
                        <option value="{{ article.id }}">{{ article.title }}</option>
                        {% endfor %}
                    </select>
                </div>
                <!-- select button -->
                <button type="button" class="btn btn-primary px-5" onclick="select_article()">Select</button>
                <!-- delete button with modal -->
                <button type="button" class="btn btn-outline-danger ms-5" data-bs-toggle="modal" data-bs-target="#deleteModal">Delete</button>
                <!-- delete confirmation modal -->
                <div class="modal fade" id="deleteModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header bg-danger">
                                <h5 class="modal-title text-light fw-bold" id="deleteModalLabel">Delete Article ?</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body bg-danger-subtle">
                                Are you sure you want to delete this article?<br>
                                <b>This cannot be undone!</b>
                            </div>
                            <div class="modal-footer bg-danger-subtle">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                <button type="button" class="btn btn-danger" data-bs-dismiss="modal" onclick="delete_article()">Delete</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- article editor -->
            <div class="container px-5 py-3 rounded-4 _shadow _bg-whitesmoke">
                <!-- headline -->
                <h1><b>Article Editor</b></h1>
                <hr class="mt-2 mb-3 _hline">
                <!-- form -->            
                <form id="article-form" method="post" action="/article-editor">
                    <!-- article id (hidden) -->
                    <input type="hidden" id="id" name="id" value="new">
                    <!-- title -->
                    <div class="mb-3">
                        <label for="title" class="form-label"><b>Title</b></label>
                        <input type="text" class="form-control" id="title" name="title" required>
                    </div>
                    <hr class="mt-2 mb-3 _hline">
                    <!-- content -->
                    <div class="mb-3">
                        <label for="content" class="form-label"><b>Content</b></label>
                        <!-- alert with markdown explanation -->
                        <div class="alert alert-info alert-dismissible fade show" role="alert">
                            Article Editor uses <strong>Markdown</strong> for formatting article content. <a href="https://www.markdownguide.org/basic-syntax/" class="alert-link text-decoration-underline">Learn more about Markdown</a>.
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                        <!-- button toolbar -->
                        <div class="btn-toolbar mb-2" role="toolbar">
                            <!-- header group -->
                            <div class="btn-group me-2 mb-2" role="group">
                                <button type="button" class="btn btn-outline-secondary" data-bs-toggle="tooltip" data-bs-placement="top" title="Header 1" onclick="markdown_h2()">##</button>
                                <button type="button" class="btn btn-outline-secondary" data-bs-toggle="tooltip" data-bs-placement="top" title="Header 2" onclick="markdown_h3()">###</button>
                                <button type="button" class="btn btn-outline-secondary" data-bs-toggle="tooltip" data-bs-placement="top" title="Header 3" onclick="markdown_h4()">####</button>
                            </div>
                            <!-- text style group -->
                            <div class="btn-group me-2 mb-2" role="group">
                                <button type="button" class="btn btn-outline-secondary" data-bs-toggle="tooltip" data-bs-placement="top" title="Bold text" onclick="markdown_bold()"><b>B</b></button>
                                <button type="button" class="btn btn-outline-secondary" data-bs-toggle="tooltip" data-bs-placement="top" title="Italic text" onclick="markdown_italic()"><i>I</i></button>
                                <button type="button" class="btn btn-outline-secondary" data-bs-toggle="tooltip" data-bs-placement="top" title="Bold and italic text" onclick="markdown_bold_italic()"><b><i>BI</i></b></button>
                            </div>
                            <!-- list group -->
                            <div class="btn-group me-2 mb-2" role="group">
                                <button type="button" class="btn btn-outline-secondary" data-bs-toggle="tooltip" data-bs-placement="top" title="Unordered list" onclick="markdown_unordered_list()">:=</button>
                                <button type="button" class="btn btn-outline-secondary" data-bs-toggle="tooltip" data-bs-placement="top" title="Ordered list" onclick="markdown_ordered_list()">1=</button>
                            </div>
                            <!-- link group -->
                            <div class="btn-group me-2 mb-2" role="group">
                                <button type="button" class="btn btn-outline-secondary" data-bs-toggle="tooltip" data-bs-placement="top" title="Insert link" onclick="markdown_link()">URL</button>
                                <button type="button" class="btn btn-outline-secondary" data-bs-toggle="tooltip" data-bs-placement="top" title="Insert image" onclick="markdown_image()">IMG</button>
                            </div>
                            <!-- block group -->
                            <div class="btn-group me-2 mb-2" role="group">
                                <button type="button" class="btn btn-outline-secondary" data-bs-toggle="tooltip" data-bs-placement="top" title="Blockquote" onclick="markdown_blockquote()">‚ùù</button>
                                <button type="button" class="btn btn-outline-secondary" data-bs-toggle="tooltip" data-bs-placement="top" title="Code block" onclick="markdown_code()">&lt/&gt</button>
                            </div>
                            <!-- horizontal line group -->
                            <div class="btn-group me-2 mb-2" role="group">
                                <button type="button" class="btn btn-outline-secondary" data-bs-toggle="tooltip" data-bs-placement="top" title="Horizontal line" onclick="markdown_horizontal_line()">_</button>
                            </div>
                            <!-- escape group -->
                            <div class="btn-group me-2 mb-2" role="group">
                                <button type="button" class="btn btn-outline-secondary" data-bs-toggle="tooltip" data-bs-placement="top" title="Escape \ ` * _ {} [] <> () # + - . ! |" onclick="markdown_escape()">\</button>
                            </div>
                        </div>
                        <!-- content textarea -->
                        <textarea class="form-control" id="content" name="content" rows="10" required></textarea>
                    </div>
                    <hr class="mt-2 mb-3 _hline">
                    <!-- content preview -->
                    <div class="mb-3">
                        <label for="content-preview" class="form-label"><b>Content Preview</b></label>
                        <div class="card">
                            <div class="card-body" id="content-preview"></div>
                        </div>
                    </div>
                    <hr class="mt-2 mb-3 _hline">
                    <!-- premium article -->
                    <label class="form-check-label mb-2"><b>Premium Article</b></label>
                    <div class="form-check ms-4 mb-3">
                        <input class="form-check-input" type="checkbox" id="premium" name="premium">
                        <label class="form-check label" for="premium">By checking this box, the article will be marked as premium.<br>Only logged in users will be able to view it.</label>
                    </div>
                    <hr class="mt-2 mb-3 _hline">
                    <!-- submit button -->
                    <button type="submit" class="btn btn-primary px-5">Submit</button>
                </form>
            </div>
        </main>
{% endblock %}
{% block js %}
        <script src="{{ url_for('static', filename='js/showdown.min.js') }}"></script>
        <script src="{{ url_for('static', filename='js/article-editor.js') }}"></script>
{% endblock %}